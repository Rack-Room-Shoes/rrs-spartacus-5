/*
 * SPDX-FileCopyrightText: 2022 SAP Spartacus team <spartacus-team@sap.com>
 *
 * SPDX-License-Identifier: Apache-2.0
 */
function isFeatureConfig(config) {
    return typeof config === 'object' && !!config.features;
}
function isInLevel(level, version) {
    if (level === '*') {
        return true;
    }
    const levelParts = level.split('.');
    const versionParts = version.split('.');
    for (let i = 0; i < versionParts.length; i++) {
        const versionNumberPart = Number(versionParts[i]);
        const levelNumberPart = Number(levelParts[i]) || 0;
        if (versionNumberPart !== levelNumberPart) {
            return levelNumberPart > versionNumberPart;
        }
    }
    return true;
}
export function isFeatureLevel(config, level) {
    if (isFeatureConfig(config) && config.features.level) {
        return level.startsWith('!')
            ? !isInLevel(config.features.level, level.substr(1, level.length))
            : isInLevel(config.features.level, level);
    }
    return false;
}
export function isFeatureEnabled(config, feature) {
    if (isFeatureConfig(config)) {
        const featureConfig = feature[0] === '!'
            ? config.features[feature.substr(1, feature.length)]
            : config.features[feature];
        const result = typeof featureConfig === 'string'
            ? isFeatureLevel(config, featureConfig)
            : featureConfig;
        return feature.startsWith('!') ? !result : !!result;
    }
    return false;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmVhdHVyZS1jb25maWctdXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jb3JlL3NyYy9mZWF0dXJlcy1jb25maWcvdXRpbHMvZmVhdHVyZS1jb25maWctdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7R0FJRztBQUtILFNBQVMsZUFBZSxDQUFDLE1BQWM7SUFDckMsT0FBTyxPQUFPLE1BQU0sS0FBSyxRQUFRLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUM7QUFDekQsQ0FBQztBQUVELFNBQVMsU0FBUyxDQUFDLEtBQWEsRUFBRSxPQUFlO0lBQy9DLElBQUksS0FBSyxLQUFLLEdBQUcsRUFBRTtRQUNqQixPQUFPLElBQUksQ0FBQztLQUNiO0lBQ0QsTUFBTSxVQUFVLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNwQyxNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBRXhDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQzVDLE1BQU0saUJBQWlCLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xELE1BQU0sZUFBZSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFbkQsSUFBSSxpQkFBaUIsS0FBSyxlQUFlLEVBQUU7WUFDekMsT0FBTyxlQUFlLEdBQUcsaUJBQWlCLENBQUM7U0FDNUM7S0FDRjtJQUNELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQUVELE1BQU0sVUFBVSxjQUFjLENBQUMsTUFBYyxFQUFFLEtBQWE7SUFDMUQsSUFBSSxlQUFlLENBQUMsTUFBTSxDQUFDLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUU7UUFDcEQsT0FBTyxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQztZQUMxQixDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2xFLENBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7S0FDN0M7SUFDRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUM7QUFFRCxNQUFNLFVBQVUsZ0JBQWdCLENBQUMsTUFBYyxFQUFFLE9BQWU7SUFDOUQsSUFBSSxlQUFlLENBQUMsTUFBTSxDQUFDLEVBQUU7UUFDM0IsTUFBTSxhQUFhLEdBQ2pCLE9BQU8sQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHO1lBQ2hCLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNwRCxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUUvQixNQUFNLE1BQU0sR0FDVixPQUFPLGFBQWEsS0FBSyxRQUFRO1lBQy9CLENBQUMsQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLGFBQWEsQ0FBQztZQUN2QyxDQUFDLENBQUMsYUFBYSxDQUFDO1FBRXBCLE9BQU8sT0FBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7S0FDckQ7SUFDRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogU1BEWC1GaWxlQ29weXJpZ2h0VGV4dDogMjAyMiBTQVAgU3BhcnRhY3VzIHRlYW0gPHNwYXJ0YWN1cy10ZWFtQHNhcC5jb20+XG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuXG5pbXBvcnQgeyBDb25maWcgfSBmcm9tICcuLi8uLi9jb25maWcvY29uZmlnLXRva2Vucyc7XG5pbXBvcnQgeyBGZWF0dXJlc0NvbmZpZyB9IGZyb20gJy4uL2NvbmZpZy9mZWF0dXJlcy1jb25maWcnO1xuXG5mdW5jdGlvbiBpc0ZlYXR1cmVDb25maWcoY29uZmlnOiBDb25maWcpOiBjb25maWcgaXMgUmVxdWlyZWQ8RmVhdHVyZXNDb25maWc+IHtcbiAgcmV0dXJuIHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnICYmICEhY29uZmlnLmZlYXR1cmVzO1xufVxuXG5mdW5jdGlvbiBpc0luTGV2ZWwobGV2ZWw6IHN0cmluZywgdmVyc2lvbjogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGlmIChsZXZlbCA9PT0gJyonKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgY29uc3QgbGV2ZWxQYXJ0cyA9IGxldmVsLnNwbGl0KCcuJyk7XG4gIGNvbnN0IHZlcnNpb25QYXJ0cyA9IHZlcnNpb24uc3BsaXQoJy4nKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHZlcnNpb25QYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHZlcnNpb25OdW1iZXJQYXJ0ID0gTnVtYmVyKHZlcnNpb25QYXJ0c1tpXSk7XG4gICAgY29uc3QgbGV2ZWxOdW1iZXJQYXJ0ID0gTnVtYmVyKGxldmVsUGFydHNbaV0pIHx8IDA7XG5cbiAgICBpZiAodmVyc2lvbk51bWJlclBhcnQgIT09IGxldmVsTnVtYmVyUGFydCkge1xuICAgICAgcmV0dXJuIGxldmVsTnVtYmVyUGFydCA+IHZlcnNpb25OdW1iZXJQYXJ0O1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmVhdHVyZUxldmVsKGNvbmZpZzogQ29uZmlnLCBsZXZlbDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGlmIChpc0ZlYXR1cmVDb25maWcoY29uZmlnKSAmJiBjb25maWcuZmVhdHVyZXMubGV2ZWwpIHtcbiAgICByZXR1cm4gbGV2ZWwuc3RhcnRzV2l0aCgnIScpXG4gICAgICA/ICFpc0luTGV2ZWwoY29uZmlnLmZlYXR1cmVzLmxldmVsLCBsZXZlbC5zdWJzdHIoMSwgbGV2ZWwubGVuZ3RoKSlcbiAgICAgIDogaXNJbkxldmVsKGNvbmZpZy5mZWF0dXJlcy5sZXZlbCwgbGV2ZWwpO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmVhdHVyZUVuYWJsZWQoY29uZmlnOiBDb25maWcsIGZlYXR1cmU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBpZiAoaXNGZWF0dXJlQ29uZmlnKGNvbmZpZykpIHtcbiAgICBjb25zdCBmZWF0dXJlQ29uZmlnID1cbiAgICAgIGZlYXR1cmVbMF0gPT09ICchJ1xuICAgICAgICA/IGNvbmZpZy5mZWF0dXJlc1tmZWF0dXJlLnN1YnN0cigxLCBmZWF0dXJlLmxlbmd0aCldXG4gICAgICAgIDogY29uZmlnLmZlYXR1cmVzW2ZlYXR1cmVdO1xuXG4gICAgY29uc3QgcmVzdWx0ID1cbiAgICAgIHR5cGVvZiBmZWF0dXJlQ29uZmlnID09PSAnc3RyaW5nJ1xuICAgICAgICA/IGlzRmVhdHVyZUxldmVsKGNvbmZpZywgZmVhdHVyZUNvbmZpZylcbiAgICAgICAgOiBmZWF0dXJlQ29uZmlnO1xuXG4gICAgcmV0dXJuIGZlYXR1cmUuc3RhcnRzV2l0aCgnIScpID8gIXJlc3VsdCA6ICEhcmVzdWx0O1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbiJdfQ==